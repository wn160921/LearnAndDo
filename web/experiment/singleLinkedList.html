<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>学习</title>
    <style type="text/css">
        /* *全局 */
        *{
            margin: 0;
            padding: 0;
        }
        ul {
            list-style: none;
        }
        #top{
            text-align: center;
            position: relative;
            width: 100%;
            height: 70px;
        }
        #top h1{
            letter-spacing: 10px;
        }
        #top .useInfo{

        }
        #top .spacing{
            margin-left: 30px;
            margin-right: 30px;
        }
        #container{
            height: 100%;
            overflow: auto;
        }
        .left{
            overflow: auto;
            height: 100%;
            float: left;
            width: 32%;
            border: green 2px solid;
        }
        .leftHandle{
            width: 4px;
            /*background-color: red;*/
            float: left;
            height: 100%;
            cursor:ew-resize;
        }
        .center{
            position: relative;
            width: 34%;
            float: left;
            height: 100%;
        }
        .centerHandle{
            float: left;
            width: 4px;
            height: 100%;
            /*background-color: red;*/
            cursor:ew-resize;
        }
        .right{
            float: left;
            height: 100%;
            width: 32%;
            border:green 1px solid;
        }

        .run{
            float: right;
        }
        .editArea{
            resize: none;
            white-space: nowrap;
        }

        .center .utilBar{
            overflow: auto;
            margin: 2px;
            background: #999999;
        }
        .center .utilBar ul li{
            text-align: center;
            display: none;
            float: left;
        }
        .center .utilBar ul li .fileName{
            color: black;
            padding-left: 2px;
            padding-right: 2px;
            background: white;
            line-height: 30px;
            cursor: pointer;
        }
        .center .utilBar ul li .codediv textarea{
            position: absolute;
            width: 98%;
            height: 95%;
            top: 30px;
            left: 3px;
            border-left: 1px green solid;
            border-right: 1px green solid;
            border-bottom: 1px green solid;

        }
        .center .utilBar ul .unselected .codediv{
            display: none;
        }
        .center .utilBar ul .unselected .fileName{
            background: #999999;
        }
        .right #result{
            width: 84%;
            float: left;
        }
        .right ul{
            float: left;
            width: 15%;
            height: auto;
        }
        .right ul li img{
            width: 25px;
            height: 25px;
        }
        .right textarea{
            height: 98%;
            border: green 1px solid;
            /*white-space: pre-wrap;*/
        }
        .over{
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: #66666666;
            z-index: 1;
            display: none;
        }
        .theEndResult{
            position: fixed;
            width: 100%;
            height: 100%;
            background-color: #ffbf30;
            z-index: 1;
            display: none;
            text-align: center;
        }

        .over .bigPicture{
            margin: 100px auto;
            background: white;
            width: 1000px;
            height: 500px;
        }
        .over .bigLeft{
            position: absolute;
            top: 50%;
            margin-top: -150px;
            margin-left: 50px;
            left: 0;
        }
        .over .bigPicture img{
            width: 100%;
            height: 100%;
        }
        .over .bigRight{
            position: absolute;
            top: 50%;
            margin-top: -150px;
            margin-right: 50px;
            right: 0;
        }


        .left ul{
            list-style: none;
        }
        .left ul li .title{
            cursor: pointer;
            font-size: 25px;
        }
        .left ul li ul li .title{
            font-size: 20px;
        }
        .left ul ul{
            margin-left: 20px;
        }

        .left ul .content{
            margin:2px 14px;
            padding: 2px;
        }
        .left ul li .codePanel{
            background:#999999;
            font-family: "Fira Code Light";
            width: 100%;
            overflow: hidden;
            white-space:nowrap;
        }
        .left .cueContent{
            padding: 2px;
            display: none;
        }
        .main{
            color: #ffc01b;
        }
        .left .check{
            border: #ffc01b 1px solid;

        }
    </style>
    <script src="../jquery-3.3.1.js"></script>
</head>
<body>
<div id="container">
    <div class="theEndResult">
        <h2>实验结果 </h2>
        <h3>用时</h3>
        <h3>剩余提示数</h3>
        <h3>变灰的步骤数</h3>
    </div>
    <div class="over">
        <div class="bigPicture">
            <canvas id="myCanvas" width="1000" height="500" style="box-shadow: 0px 0px 10px black;">
                当前浏览器不支持 canvas
            </canvas>
        </div>
        <img class="bigLeft" src="../images/bigLeft.png" alt="">
        <img class="bigRight" src="../images/bigRight.png" alt="">
    </div>
    <div id="top">
        <h1>实验一  增加节点</h1>
        <div class="useInfo">
            已用时间：<span id="time"></span><span class="spacing"></span>   剩余提示个数 <span class="cueRest">10</span>  <span class="spacing"></span> 剩余自动插入个数<span class="insertRest">8</span>
        </div>
    </div>
    <div class="left">
        <ul>
            <li>
                <div class="title"><img src="../images/arrow_down.png" alt=""><span><strong>【实验目标】</strong></span></div>
                <div class="content">
                    根据实验步骤中所提供的源码，完善LinkList.h和mian.c”两个程序文件，完成在一个链表中指定地点插入一个节点的工作，并用可视化的方法将插入前，插入后的效果展示出来。
                </div>
            </li>
            <li>
                <div class="title"><img src="../images/arrow_down.png" alt=""><strong>【实验步骤】</strong></div>
                <div>
                    <ul>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_1 创建LinkList.h</div>
                            <div class="content">
                                <div class="readyCode"></div>
                                <button class="actiontBtn1">创建</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_2 加入引用库代码(#include)</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#header">#include&lt;stdio.h&gt;</div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_3 声明节点的结构类型(typedef struct Node)</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#header">
<br>
typedef struct Node {<br>
&nbsp;&nbsp;&nbsp;&nbsp;ElemType data;<br>
&nbsp;&nbsp;&nbsp;&nbsp;struct  Node  *next;<br>
}LNode,*LinkList;<br>
<br>
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_4 初始化结构体(void InitList_L(LinkList &L))</div>
                            <div class="content">
                                <div class="cueContent">
                                    书中P45，算法2.12
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_5 头插法创建单链表(CreateList_L_Front)</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#header">
<br>
void CreateList_L_Front(LinkList &L,ElemType a[],int n )<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;LinkList p;   int i;<br>
&nbsp;&nbsp;&nbsp;&nbsp;L=(LinkList)malloc(sizeof(LNode));<br>
&nbsp;&nbsp;&nbsp;&nbsp;L->next=NULL;<br>
&nbsp;&nbsp;&nbsp;&nbsp;for(i=n-1;i>=0;i--)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=(LinkList)malloc(sizeof(LNode));<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p->data=a[i];<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p->next=L->next;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L->next=p;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
}<br>
<br>
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>

                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_6 遍历输出各节点(ListTraverse_L(mylist);)</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#header">
<br>
void ListTraverse_L(LinkList L)<br>
{<br>
&nbsp;&nbsp;&nbsp;&nbsp;LinkList p=L-&gt;next;<br>
&nbsp;&nbsp;&nbsp;&nbsp;while(p)<br>
&nbsp;&nbsp;&nbsp;&nbsp;{ <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt; setw(6)&lt;&lt;p-&gt;data;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p=p-&gt;next;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;cout&lt;&lt;endl;<br>
}<br>
<br>
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_7 插入元素操作</div>
                            <div class="content">
                                <div class="cueContent">
                                    书P47页算法2.15
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_8 插入可视化组件（必须）</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#header">
<br>
void ListVisualization_L(LinkList L)<br>
{   int temp=0;<br>
cout&lt;&lt;endl;<br>
LinkList p=L;<br>
if(p&amp;&amp;!(p-&gt;next))<br>
{<br>
cout&lt;&lt;&quot;dot代码 digraph g { rankdir=LR; node [shape = \&quot;record\&quot; width = 0.5];node0  [label = \&quot;&lt;data&gt; //// | &lt;next&gt;  ^\&quot;];&quot;;<br>
}<br>
else if(p&amp;&amp;(p-&gt;next))<br>
{<br>
cout&lt;&lt;&quot;dot代码 digraph g { rankdir=LR; node [shape = \&quot;record\&quot; width = 0.5];node0  [label = \&quot;&lt;data&gt; //// | &lt;next&gt;  \&quot;];&quot;;<br>
while(p-&gt;next)<br>
{<br>
printf(&quot;node%d [label =\&quot;&lt;data&gt; %d| &lt;next&gt;\&quot;]  node%d:next -&gt; node%d:data;&quot;,temp+1, p-&gt;next-&gt;data,temp,temp+1);<br>
p=p-&gt;next;<br>
temp++;<br>
}<br>
}<br>
cout&lt;&lt;&quot;}&quot;&lt;&lt;endl;<br>
}<br>
<br>
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_9 创建code.c文件</div>
                            <div class="content">
                                <button class="actiontBtn2">创建</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_10 插入#include</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#code">
<br>
typedef  int ElemType;<br>
# include &quot;stdlib.h&quot;<br>
# include &quot;iostream&quot;<br>
# include &quot;iomanip&quot;<br>
using namespace std;<br>
# include &quot;LinkList.h&quot;<br>
<br>
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_11 创建main方法</div>
                            <div class="content">
                                <div class="cueContent">
                                    int main(){<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;return 0;<br>
                                    }<br>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_12 调用LinkList.h中的函数声明mylist</div>
                            <div class="content">
                                <div class="cueContent">
                                    LinkList mylist;
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_13 调用LinkList.h中的函数初始化mylist</div>
                            <div class="content">
                                <div class="cueContent">
                                    InitList_L(mylist);
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_14 创建含有五个值的整形数组a[]</div>
                            <div class="content">
                                <div class="cueContent">
                                    int a[]={6,8,16,2,34};
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_15 调用LinkList.h中的函数，头插法创建链表</div>
                            <div class="content">
                                <div class="cueContent">
                                    CreateList_L_Front(mylist,a,5);
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_16 调用LinkList.h中的函数，遍历打印链表</div>
                            <div class="content">
                                <div class="cueContent">
                                    ListTraverse_L(mylist);
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_17 加入可视化功能</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#code">
                                        ListVisualization_L(mylist);
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_18 运行程序</div>
                            <div class="content">
                                <!--记分内容-->
                                <div class="check">
                                    <div>是否成功执行？</div>
                                    <div>是否成功打印五个元素的链表？</div>
                                    <div>图像是否正确</div>
                                </div>
                                <button class="checkRun18">运行</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_19 调用LinkList.h中的函数，在链表的第二个元素后面插入一个新的元素’888‘</div>
                            <div class="content">
                                <div class="cueContent">
                                    ListInsert_L(mylist,2,888);
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_20 调用LinkList.h中的函数，遍历打印链表</div>
                            <div class="content">
                                <div class="cueContent">
                                    ListTraverse_L(mylist);
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title"><img src="../images/arrow_down.png" alt="">step_21 加入可视化功能</div>
                            <div class="content">
                                <div class="cueContent">
                                    <div class="codePanel" aim="#code">
                                        ListVisualization_L(mylist);
                                    </div>
                                    <button class="insertBtn">插入</button>
                                </div>
                                <button class="cueBtn">提示</button>
                            </div>
                        </li>
                        <li>
                            <div class="title main"><img src="../images/arrow_down.png" alt="">step_22 运行，看是否插入成功</div>
                            <div class="content">
                                <div class="check">
                                    运行是否成功
                                </div>
                                <button class="checkRun22">运行</button>
                            </div>
                        </li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>
    <div class="leftHandle">

    </div>
    <div class="center">
        <div class="utilBar">
            <input type="button" value="运行" class="run"/>
            <ul>
                <li class="unselected">
                    <div class="fileName">LinkedList.h</div>
                    <div class="codediv">
                        <textarea id="header" spellcheck="false" class="editArea">

                        </textarea>
                    </div>
                </li>
                <li>
                    <div class="fileName">code.c</div>
                    <div class="codediv">
                        <textarea id="code" spellcheck="false" class="editArea">

                        </textarea>
                    </div>
                </li>
            </ul>
        </div>

    </div>
    <div class="centerHandle">

    </div>
    <div class="right">
            <textarea id="result" wrap="hard" class="editArea">

            </textarea>
            <ul>

            </ul>
    </div>
</div>
<script>
    var changeGreyNum = 0;
    //计时起
    var timeSpan = document.getElementById("time");
    var n= 0, timer=null;
    //开始计时
    function startTime() {
        console.log("start timer");
        clearInterval(timer);
        timer=setInterval(function () {
            n++;
            var m=parseInt(n/60);
            var s=parseInt(n%60);
            timeSpan.innerHTML=toDub(m)+":"+toDub(s);
        },1000);
    };
    //暂停并且清空计时器
    function stop() {
        clearInterval(timer);
    }
    //重置
    function reSet() {
        timeSpan.innerHTML="00:00";
        n=0;
    }
    //补零
    function toDub(n){
        return n<10?"0"+n:""+n;
    }
    startTime();

    //边框位置
    var leftDrag = false;
    var centerDrag = false;
    var mouseX=0;
    $(".leftHandle").mousedown(function (event) {
        $(".left").css("overflow","hidden");
        $(".center").css("overflow","hidden");
        mouseX = event.pageX;
        leftDrag = true;

    });
    $(".leftHandle").on("mouseup",function () {
        leftDrag = false;
        $(".left").css("overflow","auto");
        $(".center").css("overflow","auto");
    });
    $(".left").on("mouseup",function () {
        leftDrag = false;
        $(".left").css("overflow","auto");
        $(".center").css("overflow","auto");
    });
    $(".left").mousemove(function (event) {
        if(leftDrag){
            a=event.pageX-mouseX;
            leftHandleMove(a);
            mouseX=event.pageX;
        }
    });
    $(".center").on("mouseup",function () {
        leftDrag = false;
        $(".left").css("overflow","auto");
        $(".center").css("overflow","auto");
    });
    $(".center").mousemove(function (event) {
        if(leftDrag){
            a=event.pageX-mouseX;
            leftHandleMove(a);
            mouseX=event.pageX;
        }
        if(centerDrag){
            a=event.pageX-mouseX;
            centerHandleMove(a);
            mouseX=event.pageX;
        }
    });
    $(".leftHandle").mousemove(function (event) {
        if(leftDrag){
            a=event.pageX-mouseX;
            leftHandleMove(a);
            mouseX=event.pageX;
        }
    });
    function leftHandleMove(X) {
        var leftW = $(".left").width();
        console.log("f"+leftW);
        leftW = leftW + X;
        console.log("s"+leftW);
        var centerW = $(".center").width();
        centerW = centerW - X;
        $(".left").width(leftW);
        console.log("gaibianhpu"+$(".left").width());
        $(".center").width(centerW);
    }
  //照着上面再来一次，有机会再整合
    $(".centerHandle").mousedown(function (event) {
        $(".right").css("overflow","hidden");
        $(".center").css("overflow","hidden");
        mouseX = event.pageX;
        centerDrag = true;

    });
    $(".centerHandle").on("mouseup",function () {
        centerDrag = false;
        $(".right").css("overflow","auto");
        $(".center").css("overflow","auto");
    });
    $(".right").on("mouseup",function () {
        centerDrag = false;
        $(".right").css("overflow","auto");
        $(".center").css("overflow","auto");
    });
    $(".right").mousemove(function (event) {
        if(centerDrag){
            a=event.pageX-mouseX;
            centerHandleMove(a);
            mouseX=event.pageX;
        }
    });
    $(".centerHandle").mousemove(function (event) {
        if(centerDrag){
            a=event.pageX-mouseX;
            centerHandleMove(a);
            mouseX=event.pageX;
        }
    });
    function centerHandleMove(X) {
        var rightW = $(".right").width();
        rightW = rightW - X;
        var centerW = $(".center").width();
        centerW = centerW + X;
        $(".right").width(rightW);
        $(".center").width(centerW);
    }



    //提示次数
    var cueNum = 0;
    $("body").height($(window).height());
    //主要是left的代码
    $(".left .title").click(function (event) {
        changeGreyNum+=1;
        var checkOpen = $(this).next().css("display");
        console.log("brother display"+checkOpen);
        if(checkOpen!="none"){
            $(this).next().hide();
            $(this).children("img").attr("src","../images/arrow_right.png");
        }else {
            $(this).next().show();
            $(this).children("img").attr("src","../images/arrow_down.png");
        }
    });

    function insertAfterCursor(area,data){
        console.log(area);
        area = document.getElementById(area);
        $(area).focus();
        console.log("focus");
        console.log(area.selectionStart);
        if(document.selection){
            console.log("位置1");
            var sel = document.selection().createRange();
            sel.txt = data;
        }else if(typeof area.selectionStart==="number"&&typeof area.selectionEnd==="number"){
            console.log('location 2');
            var startPos = area.selectionStart,
                endPos = area.selectionEnd,
                curPos = startPos,
                tempStr = area.value;
            var value = tempStr.substring(0,startPos)+data+tempStr.substring(endPos,tempStr.length);
            area.value=value;
            curPos+=value.length;
            area.selectionStart = area.selectionEnd = curPos;
        }else {
            console.log("location3");
            area.value=area.value+data;
        }
    }

    $(".actiontBtn1").click(function () {
        changeGreyNum+=1;
        $(".center .utilBar ul li").first().show().click();
        $(this).parent().prev().css("color","#cccccc")
        $(this).hide();
    });
    $(".actiontBtn2").click(function () {
        changeGreyNum+=1;
        $(".center .utilBar ul li").first().next().show().click();
        $(this).parent().prev().css("color","#cccccc")
        $(this).hide();
    });
    $(".left .insertBtn").click(function () {
        changeGreyNum+=1;
        var code = $(this).prev().text();
        console.log("code:"+code);
        var textarea = $(this).prev().attr("aim");
        insertAfterCursor(textarea.substring(1,textarea.length),code);
        console.log(textarea);
        $(this).prev().css("background-color","#cccccc");
        $(this).parent().prev().css("color","#cccccc");
        $(this).hide();
    });
    $(".left .cueBtn").click(function () {
        changeGreyNum+=1;
        $(this).prev().show();
        $(this).prev().css("background-color","#cccccc");
        $(this).hide();
        cueNum++;
        //标题变灰
        $(this).parent().prev().css("color","#cccccc");
        $("#top .cueRest").text(10-cueNum);
    });

    var isrun = true;
    var step18ClickResult = new Array();
    $(".left .checkRun18").click(function () {
        isrun = true;
        if(step18ClickResult.length==0){
            changeGreyNum+=1;
        }
        runClick();
        //运行结果目标达成数
        var stepResult = 0;
        if(listarray.length==1){
            stepResult+=1;
            if(listarray[0].length==5){
                stepResult+=1;
                //第三个目标不检查
            }
            stepResult+=1;
        }
        console.log("stepresult"+stepResult);
        step18ClickResult[step18ClickResult.length]=stepResult;
        if(stepResult==3){
            $(this).prev().css("background-color","#cccccc");
            $(this).text("success");
            $(this).hide()
        }else {
            $(this).prev().css("background-color","#CC3E38");
        }
    });
    var step22ClickResult = new Array();
    $(".left .checkRun22").click(function () {
        isrun = true;
        if(step22ClickResult.length==0){
            changeGreyNum+=1;
        }
        runClick();
        //运行结果目标达成数
        var stepResult = 0;
        if(listarray.length==2){
            if(listarray[1][2]==888){
                stepResult+=1;
            }
        }
        step22ClickResult[step18ClickResult.length]=stepResult;
        if(stepResult==1){
            $(this).prev().css("backgroud-color","#cccccc");
            $(this).text("success");
            $(this).hide();
            $(".theEndResult").empty();
            $(".theEndResult").append("<h3>实验成功</h3>");
            $(".theEndResult").append("<h4>"+timeSpan.innerHTML+"</h4>");
            $(".theEndResult").append("<h4>剩余提示数"+$(".cueRest").text()+"</h4>");
            $(".theEndResult").append("<h4>变灰步骤数"+changeGreyNum+"</h4>");
            $(".theEndResult").show();
        }else {
            $(this).prev().css("backgroud-color","red");
            $(".theEndResult").empty();
            $(".theEndResult").append("<h3>实验完成</h3>");
            $(".theEndResult").append("<h4>"+timeSpan.innerHTML+"</h4>");
            $(".theEndResult").append("<h4>剩余提示数"+$(".cueRest").text()+"</h4>");
            $(".theEndResult").append("<h4>变灰步骤数"+changeGreyNum+"</h4>");
            $(".theEndResult").show();
        }
    });



    $("textarea").keydown(function (e) {
        event = e||window.event;
        console.log(event.which);
        if(event.keyCode===9){
            event.preventDefault();
            var position=this.selectionStart+4;//此处我用了两个空格表示缩进，其实无所谓几个，只要和下面保持一致就好了。
            this.value=this.value.substr(0,this.selectionStart)+'    '+this.value.substr(this.selectionStart);
            this.selectionStart=position;
            this.selectionEnd=position;
            this.focus();
            event.returnValue=false;
        }
    });
    $(".over .bigLeft").click(function (event) {
        clearCanvas();
        console.log("left");
        event.stopPropagation();
        var picNum = $("#myCanvas").attr("picNum");
        var currSrcIndex = picNum;
        if(currSrcIndex==1){
            $("#myCanvas").attr("picNum",listarray.length);
        }else{
            $("#myCanvas").attr("picNum",currSrcIndex-1);
        }
        console.log("left picNum:"+$("#myCanvas").attr("picNum"))
        drawLinkList(listarray[$("#myCanvas").attr("picNum")-1]);
    });
    $(".over .bigRight").click(function (event) {
        event.stopPropagation();
        clearCanvas();
        console.log("right");
        var picNum = $("#myCanvas").attr("picNum");
        var currSrcIndex = parseInt(picNum);
        if(currSrcIndex==listarray.length){
            $("#myCanvas").attr("picNum",1);
        }else{
            $("#myCanvas").attr("picNum",currSrcIndex+1)
        }
        drawLinkList(listarray[$("#myCanvas").attr("picNum")-1]);
    });
    $(".over").click(function () {
        $(this).hide();
    });
    //存储链表数据
    var listarray;
    function getArray(str) {
        var arr = new Array();
        var reg = /表中的元素依次为：\n.*\n/g;
        var datas = str.match(reg);
        for(var key in datas){
            var reg2=/\d+/g;
            arr[key]=datas[key].match(reg2);
        }
        return arr;
    }

    //绘图
    var canvas_1 = document.getElementById("myCanvas");
    // 获取在 canvas 上绘图的 canvasRenderingContent2D 对象
    var ctx = canvas_1.getContext("2d");
    function drawArrow(x,y){
        ctx.beginPath();
        //设置绘制起点
        ctx.moveTo(x,y);
        //设置绘制下一个点
        ctx.lineTo(x,y+1.25);
        ctx.lineTo(x+40,y+1.25)
        ctx.lineTo(x+40,y+3.75);
        ctx.lineTo(x+50,y);
        ctx.lineTo(x+40,y-3.75);
        ctx.lineTo(x+40,y-1.25);
        ctx.lineTo(x,y-1.25);
        //结束绘制
        ctx.closePath();
        //设置线的宽度
        ctx.lineWidth = 1;
        //绘制点之间的线路
        ctx.fill();
    }

    function drawHeadElement(x,y) {
        drawArrow(x,y);
        ctx.font = 'italic 40px 隶书';
        ctx.textBaseline = 'top';
        ctx.fillText('L',x,y-40);
        ctx.fillRect(x+50,y-20,45,40);
        ctx.strokeRect(x+95,y-19,35,38);
        drawArrow(x+110,y);
    }

    function drawEndElement(x,y,data) {
        ctx.strokeRect(x,y-19,45,38);
        ctx.strokeRect(x+45,y-19,35,38);
        ctx.beginPath();
        //设置绘制起点
        ctx.moveTo(x+50,y+10);
        ctx.lineTo(x+60,y-10);
        ctx.lineTo(x+70,y+10);
        //结束绘制
        //ctx.closePath();
        //设置线的宽度
        ctx.lineWidth = 1;
        //绘制点之间的线路
        ctx.stroke();
        ctx.font = 'italic '+30/Math.sqrt(data.length)+'px'+' 隶书';
        ctx.textBaseline = 'middle';
        ctx.fillText(data,x+5,y);
    }

    function  drawMiddleElement(x,y,data) {
        ctx.strokeRect(x,y-19,45,38);
        ctx.strokeRect(x+45,y-19,35,38);
        drawArrow(x+60,y);
        ctx.font = 'italic '+30/Math.sqrt(data.length)+'px'+' 隶书';
        ctx.textBaseline = 'middle';
        ctx.fillText(data,x+5,y);
    }
    function drawLinkList(data) {
        console.log("listdata:"+data)
        var length = data.length;
        ctx.fillStyle="#999";
        ctx.strokeStyle="#999";
        drawHeadElement(40,250);
        if(length==1){
            drawEndElement(200,250);
        }else {
            var i=0,x=200,y=250;
            for(i=0;i<length-1;i++){
                drawMiddleElement(x,y,data[i]);
                x=x+110;
            }
            drawEndElement(x,y,data[length-1]);
        }
    }
    function clearCanvas()
    {
        canvas_1.height = canvas_1.height;
    }

    $(".run").click(runClick);
    function runClick(){
        listarray=null;
        //alert("click");
        console.log("click");
        console.log("code is:"+$("#code").val());
        $("#result").val("");
        $(".right ul").empty();
        $.ajax({
            type:"post",
            url:"../test",data: {
                "code":$("#code").val(),
                "LinkList.h":$("#header").val()
            },
            async:false,
            success:function (data,status) {
                console.log(data);
                data = $.parseJSON(data);
                $("#result").val(data.result);
                listarray = getArray(data.result);
                $(".right ul").empty();
                var i = 1;
                for (i = 1; i <= listarray.length; i++) {
                    $(".right ul").append("<li><img src='../images/pic.png' picNum='" + i + "' alt=\"\"></li>")
                }
                $(".right ul li").click(function (event) {
                    $(".over").show();
                    $("#myCanvas").attr("picNum", $(this).children().attr("picNum"));
                    clearCanvas();
                    drawLinkList(listarray[$("#myCanvas").attr('picNum') - 1]);
                });
                isrun = false;
            }});
    }
    $(".center .utilBar ul li").click(function () {
        $(this).removeClass("unselected").siblings().addClass("unselected");
    })
</script>
</body>

</html>